/*! Delivery Estimate: Handlebars Templates + delivery-estimate.js 14-12-2016 */
this.JST=this.JST||{},this.JST["js/delivery-estimate/delivery-estimate.hbs"]=Handlebars.template({1:function(a,b,c,d,e){return"un"},3:function(a,b,c,d,e){var f,g=null!=b?b:{},h=a.lambda,i=a.escapeExpression;return"        <p><strong>"+(null!=(f=(c.compare||b&&b.compare||c.helperMissing).call(g,null!=(f=null!=b?b.standard:b)?f.price:f,"==","0.00",{name:"compare",hash:{},fn:a.program(4,e,0),inverse:a.noop,data:e}))?f:"")+"Standard shipping ($"+i(h(null!=(f=null!=b?b.standard:b)?f.price:f,b))+")</strong><br>\n            <span>Order "+(null!=(f=c["if"].call(g,null!=b?b.cutoff:b,{name:"if",hash:{},fn:a.program(6,e,0),inverse:a.program(8,e,0),data:e}))?f:"")+" to get your goodies delivered on "+i(h(null!=(f=null!=b?b.standard:b)?f.date:f,b))+".</span></p>\n"},4:function(a,b,c,d,e){return"FREE "},6:function(a,b,c,d,e){var f;return"before "+a.escapeExpression((f=null!=(f=c.cutoff||(null!=b?b.cutoff:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"cutoff",hash:{},data:e}):f))},8:function(a,b,c,d,e){return"now"},10:function(a,b,c,d,e){return"        <p>Sorry, standard shipping is temporarily unavailable.</p>\n"},12:function(a,b,c,d,e){var f,g=a.lambda,h=a.escapeExpression;return"        <p><strong>Express shipping ($"+h(g(null!=(f=null!=b?b.express:b)?f.price:f,b))+")</strong><br>\n            <span>Order "+(null!=(f=c["if"].call(null!=b?b:{},null!=b?b.cutoff:b,{name:"if",hash:{},fn:a.program(6,e,0),inverse:a.program(8,e,0),data:e}))?f:"")+" to get your goodies delivered on "+h(g(null!=(f=null!=b?b.express:b)?f.date:f,b))+".</span></p>\n"},14:function(a,b,c,d,e){return"        <p>Sorry, express shipping is temporarily unavailable.</p>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return"<h3>Delivery estimate for "+a.escapeExpression((g=null!=(g=c.postcode||(null!=b?b.postcode:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"postcode",hash:{},data:e}):g))+'</h3>\n<div class="standard '+(null!=(f=c.unless.call(h,null!=(f=null!=b?b.standard:b)?f.status:f,{name:"unless",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'available">\n'+(null!=(f=c["if"].call(h,null!=(f=null!=b?b.standard:b)?f.status:f,{name:"if",hash:{},fn:a.program(3,e,0),inverse:a.program(10,e,0),data:e}))?f:"")+'</div>\n<div class="express '+(null!=(f=c.unless.call(h,null!=(f=null!=b?b.express:b)?f.status:f,{name:"unless",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'available">\n'+(null!=(f=c["if"].call(h,null!=(f=null!=b?b.express:b)?f.status:f,{name:"if",hash:{},fn:a.program(12,e,0),inverse:a.program(14,e,0),data:e}))?f:"")+"</div>"},useData:!0}),function(a){"use strict";function b(a,b,d){var e=JST["js/delivery-estimate/delivery-estimate.hbs"];b.html(e(a)),d&&(c.removeClass("isloading"),c.find(".btn").prop("disabled",!1))}var c=a(".delivery-estimate"),d=c.find('input[name="postcode"]'),e=a.jStorage.get("pbDeliverEstimate");e&&d.val(e.postcode),c.on("click",".btn",function(c){var d=a(this).prop("disabled",!0),f=d.closest(".delivery-estimate"),g=f.find(".results"),h=f.find('input[name="postcode"]'),i=new RegExp("^(0[289][0-9]{2})|([1345689][0-9]{3})|(2[0-8][0-9]{2})|(290[0-9])|(291[0-4])|(7[0-4][0-9]{2})|(7[8-9][0-9]{2})$");if(e=a.jStorage.get("pbDeliverEstimate"),!i.test(h.val()))return f.addClass("error"),void g.text("Please enter a valid Australian postcode.");if(e&&e.postcode===h.val())return void b(e,g,!0);var j=f.find('input[name="form_key"]');d.prop("disabled",!0),f.removeClass("error").addClass("isloading"),a.ajax({url:j.data("baseUrl")+"auspost/delivery/date",data:f.find(":input").serializeArray(),dataType:"json",method:"post"}).done(function(c){a.extend(!0,c,{postcode:h.val(),cutoff:f.attr("data-cutoff"),standard:{price:f.attr("data-standard-price")}}),a.jStorage.set("pbDeliverEstimate",c,{TTL:36e5}),b(c,g,!1)}).fail(function(a){f.addClass("error"),console.log(a),a&&a.responseJSON?g.text(a.responseJSON.message):g.text("There was an error fetching your delivery estimate.")}).always(function(){f.removeClass("isloading"),d.prop("disabled",!1)})}).on("keyup","input",function(b){if(13===b.keyCode){b.preventDefault();var c=a(this).closest(".delivery-estimate").find(".btn").not(":disabled");c.click()}})}(jQuery);